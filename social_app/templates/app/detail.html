{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}blog{% endblock %}</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/output.css' %}">
</head>
<body>
<main>
    <div class="container">
        <h1 class="text-center font-bold text-4xl">post</h1>
<p>{{ post.discription }}</p>

    {% for photo in post.images.all %}
                            <img src="{{ photo.image.url }}" alt="" style="width: 20rem;">
                        {% endfor %}
<p>This post created by {{ post.author }} in {{ post.created|date:'y/m/d' }}</p>
<h2>Tags: {% for tag in post.tags.all %}
<a href="{% url 'social:get_posts_tag' tag.slug %}"> {{ tag }}</a>
{% endfor %}
</h2>
    <div class="post  " data-post_id="{{ post.id }}">
        <button class="like-btn border rounded-lg p-2">{% if request.user in post.likes.all %}
            unlike
            {% else %}
            like
        {% endif %} </button>
    <p class="likes-count">{{ post.likes.count }}</p>
    </div>
<br><br><br><br><br>
<h1 class="text-center font-bold text-4xl">similar posts</h1>
{% for similar_post in similar_posts %}
    <a href="{% url 'social:detail' similar_post.id %}">{{ similar_post|truncatewords:20 }}</a>
    <br>
{% endfor %}

<div class="flex gap-4 justify-between">
        {% for post in posts %}
                    <div class="border rounded-lg bg-blue-800 overflow-hidden w-[18rem] h-[23rem]">
                    <div class="w-full h-1/2 ">


                    </div>
                    <div class="w-full h-1/2 text-white p-2 flex flex-col justify-between">
                        <a href="{% url 'social:detail' post.id %}" class="line-clamp-4 ">{{ post.discription }}</a>
                        <p class="">Tags : {% for tag in post.tags.all %} <a href="{% url 'social:get_posts_tag' tag.slug %}">{{ tag }}</a>{% endfor %}</p>
                        <div class="flex justify-between">
                            <p class="" id="name">This post made by {{ post.author }} in {{ post.created|date:'y/m/d' }}</p>
                        </div>
                    </div>
                </div>
                {% endfor %}


</div>
{% include 'forms/comments.html' %}
    </div>
</main>
<script type="text/javascript">

    {## change this code to vanilla javascript#}
{#$(document).ready(function() {#}
{#        $('.like-button').click(function() {#}
{#			var post_id = $(this).closest('.post').data('post-id');#}
{#            var  button = $(this);#}
{##}
{#            $.ajax({#}
{#                type: 'POST',#}
{#                url: '{% url 'social:like_post' %}',#}
{#                data: {'post_id': post_id, 'csrfmiddlewaretoken': '{{ csrf_token }}'},#}
{#                success: function(data) {#}
{#                    if (data.liked){#}
{#                        button.text('UnLike');#}
{#                    } else {#}
{#                        button.text('Like');#}
{#                    }#}
{#                    $('.likes-count').text(data.likes_count);#}
{#                },#}
{#            });#}
{#        });#}
</script>
</body>
</html>